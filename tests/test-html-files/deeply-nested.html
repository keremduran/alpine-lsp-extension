<!DOCTYPE html>
<html>
<head>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
</head>
<body>
    <!-- Test 1: Deeply nested object access -->
    <div x-data="{
        company: {
            name: 'TechCorp',
            info: {
                address: {
                    street: '123 Main St',
                    city: 'San Francisco',
                    state: 'CA',
                    country: {
                        code: 'US',
                        name: 'United States',
                        continent: 'North America'
                    }
                },
                contact: {
                    phone: {
                        main: '+1-555-0100',
                        support: '+1-555-0199',
                        fax: '+1-555-0101'
                    },
                    email: {
                        general: 'info@techcorp.com',
                        support: 'support@techcorp.com',
                        sales: 'sales@techcorp.com'
                    }
                }
            },
            departments: {
                engineering: {
                    head: 'John Doe',
                    budget: 1000000,
                    teams: {
                        frontend: {
                            lead: 'Jane Smith',
                            members: 5,
                            projects: ['Website', 'Mobile App']
                        },
                        backend: {
                            lead: 'Bob Johnson',
                            members: 8,
                            projects: ['API', 'Database', 'Microservices']
                        }
                    }
                },
                marketing: {
                    head: 'Alice Brown',
                    budget: 500000,
                    campaigns: {
                        active: ['Summer Sale', 'Product Launch'],
                        planned: ['Black Friday', 'Holiday Season']
                    }
                }
            }
        }
    }">
        <!-- Testing deep property access -->
        <p x-text="company.name"></p>
        <p x-text="company.info.address.street"></p>
        <p x-text="company.info.address.city"></p>
        <p x-text="company.info.address.country.name"></p>
        <p x-text="company.info.address.country.continent"></p>
        <p x-text="company.info.contact.phone.main"></p>
        <p x-text="company.info.contact.email.support"></p>
        <p x-text="company.departments.engineering.head"></p>
        <p x-text="company.departments.engineering.teams.frontend.lead"></p>
        <p x-text="company.departments.engineering.teams.frontend.members"></p>

        <!-- Nested loops -->
        <template x-for="project in company.departments.engineering.teams.frontend.projects">
            <li x-text="project"></li>
        </template>
    </div>

    <!-- Test 2: Mixed nested structures with methods -->
    <div x-data="{
        app: {
            user: {
                profile: {
                    firstName: 'John',
                    lastName: 'Doe',
                    fullName() {
                        return this.firstName + ' ' + this.lastName
                    },
                    settings: {
                        theme: 'dark',
                        notifications: {
                            email: true,
                            push: false,
                            sms: true,
                            preferences: {
                                frequency: 'daily',
                                types: ['updates', 'promotions', 'alerts']
                            }
                        }
                    }
                },
                permissions: {
                    admin: false,
                    editor: true,
                    viewer: true,
                    canEdit() {
                        return this.admin || this.editor
                    }
                }
            },
            data: {
                posts: [
                    {
                        id: 1,
                        title: 'First Post',
                        content: 'Hello World',
                        meta: {
                            author: 'John',
                            date: '2024-01-01',
                            tags: ['intro', 'welcome'],
                            stats: {
                                views: 100,
                                likes: 10,
                                comments: [
                                    { user: 'Alice', text: 'Great post!' },
                                    { user: 'Bob', text: 'Thanks for sharing' }
                                ]
                            }
                        }
                    }
                ]
            }
        }
    }">
        <!-- Deep method calls and property access -->
        <p x-text="app.user.profile.fullName()"></p>
        <p x-text="app.user.profile.settings.theme"></p>
        <p x-text="app.user.profile.settings.notifications.email"></p>
        <p x-text="app.user.profile.settings.notifications.preferences.frequency"></p>
        <p x-text="app.user.permissions.canEdit()"></p>

        <!-- Nested array access -->
        <p x-text="app.data.posts[0].title"></p>
        <p x-text="app.data.posts[0].meta.author"></p>
        <p x-text="app.data.posts[0].meta.stats.views"></p>
        <p x-text="app.data.posts[0].meta.stats.comments[0].user"></p>

        <!-- Nested loops with deep objects -->
        <template x-for="post in app.data.posts">
            <div>
                <h3 x-text="post.title"></h3>
                <template x-for="comment in post.meta.stats.comments">
                    <p>
                        <span x-text="comment.user"></span>:
                        <span x-text="comment.text"></span>
                    </p>
                </template>
            </div>
        </template>
    </div>

    <!-- Test 3: Complex computed properties with deep access -->
    <script>
        function complexApp() {
            return {
                state: {
                    ui: {
                        sidebar: {
                            expanded: true,
                            width: 250,
                            items: {
                                main: ['Dashboard', 'Analytics', 'Reports'],
                                tools: ['Settings', 'Help', 'About']
                            }
                        },
                        modals: {
                            settings: {
                                visible: false,
                                data: {
                                    general: {
                                        language: 'en',
                                        timezone: 'UTC'
                                    }
                                }
                            }
                        }
                    }
                },
                getSidebarItem(category, index) {
                    return this.state.ui.sidebar.items[category]?.[index] || 'Not found'
                },
                toggleModal(modalName) {
                    if (this.state.ui.modals[modalName]) {
                        this.state.ui.modals[modalName].visible = !this.state.ui.modals[modalName].visible
                    }
                }
            }
        }
    </script>
    <div x-data="complexApp()">
        <p x-text="state.ui.sidebar.width"></p>
        <p x-text="getSidebarItem('main', 0)"></p>
        <p x-text="state.ui.modals.settings.data.general.language"></p>
        <button @click="toggleModal('settings')">Toggle Settings</button>
        <div x-show="state.ui.modals.settings.visible">
            Settings Modal
        </div>
    </div>
</body>
</html>