<!DOCTYPE html>
<html>
<head>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
</head>
<body>
    <!-- Test 1: Object literal x-data -->
    <div x-data="{ count: 0, message: 'Hello Alpine', increment() { this.count++ }, test() {return 'HELLO WORLD'} }">
        <button @click="increment()">Increment</button>
        <button @click="test()">Increment</button>

        <button @click="count--">Decrement</button>
        <p x-text="count"></p>
        <p x-show="count === 'test'">Count is positive</p>
        <p x-text="message"></p>

        <!-- Test undefined variable (should show warning) -->
        <p x-text="undefinedVar"></p>

        <!-- Test magic properties -->
        <button @click="$dispatch('custom-event')">Dispatch Event</button>
        <div x-ref="myDiv">Referenced Div</div>
        <button @click="console.log($refs.myDiv)">Log Ref</button>
    </div>

    <!-- Test 2: Nested components -->
    <div x-data="{ parentValue: 'parent' }">
        <p x-text="parentValue"></p>

        <div x-data="{ childValue: {hello: 'test', sup: '123'} }">
            <p x-text="childValue.hello"></p>
            <!-- Should warn: parentValue not accessible here in Alpine -->
            <p x-text="parentValue"></p>
        </div>
    </div>

    <!-- Test 3: x-for loop -->
    <div x-data="{ items: ['Apple', 'Banana', 'Orange'] }">
        <template x-for="item in items">
            <li x-text="item"></li>
        </template>
    </div>

    <!-- Test 4: x-data as function (would need external function) -->
    <script>
        function counter() {
            return {
                count: 2,
                hello: "world",
                items: [{id: "1", name: "test"}, {id: "2", name: "test"}, {id: "2", name: "test", age: "20"}],
                increment() {
                    this.count++
                },
                testExpression() {
                    const {count, hello, items, increment} = this;
                    // @click found
                    {increment()}

                    // x-show value found for example
                    {count === "test" && hello == "world"};

                    // x-for value found
                    {item in items}

                }
            }
        }
    </script>
    <div x-data="counter()">
        <button @click="increment()">Click me</button>
        <span x-text="hello"></span>
    </div>
</body>
</html>